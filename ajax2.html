<!DOCTYPE html>
<html>
<head>
    <title>Analyze Sample</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
</head>
<body>

<script type="text/javascript">
    function processImage() {
        // **********************************************
        // *** Update or verify the following values. ***
        // **********************************************

        // let subscriptionKey = process.env['COMPUTER_VISION_SUBSCRIPTION_KEY'];
        // let endpoint = process.env['COMPUTER_VISION_ENDPOINT']
        let subscriptionKey = '467b3c735c0a4779a19575f9a70a1bb3';
        let endpoint = 'https://3744p5.cognitiveservices.azure.com/';
        if (!subscriptionKey) { throw new Error('Set your environment variables for your subscription key and endpoint.'); }
        
        var uriBase = endpoint + "vision/v2.1/analyze";

        // Request parameters.
        var params = {
            "visualFeatures": "Categories,Description,Color",
            "details": "",
            "language": "en",
        };

        // Display the image.
        var sourceImageUrl = "https://upload.wikimedia.org/wikipedia/commons/3/3c/Shaki_waterfall.jpg";
        // document.querySelector("#sourceImage").src = sourceImageUrl;

        // Make the REST API call.
        $.ajax({
            url: uriBase + "?" + $.param(params),

            // Request headers.
            beforeSend: function(xhrObj){
                xhrObj.setRequestHeader("Content-Type","application/json");
                xhrObj.setRequestHeader(
                    "Ocp-Apim-Subscription-Key", subscriptionKey);
            },

            type: "POST",

            // Request body.
            data: '{"url": ' + '"' + sourceImageUrl + '"}',
            success: function(data)
            {
                $("#responseTextArea").val(JSON.stringify(data, null, 2));
            },
            error: function (xhr, status, error) {
            alert("error"+xhr.responseText);
            }
        });

        // .done(function(data) {
        //     // Show formatted JSON on webpage.
        //     $("#responseTextArea").val(JSON.stringify(data, null, 2));
        // })

        // .fail(function(jqXHR, textStatus, errorThrown) {
        //     // Display error message.
        //     var errorString = (errorThrown === "") ? "Error. " :
        //         errorThrown + " (" + jqXHR.status + "): ";
        //     errorString += (jqXHR.responseText === "") ? "" :
        //         jQuery.parseJSON(jqXHR.responseText).message;
        //     alert(errorString);
        // });
    };
</script>
<body>
Image to analyze:

<button onclick="processImage()">Analyze image</button>

</body>
</html>